(function(n,r){typeof exports=="object"&&typeof module<"u"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(n=typeof globalThis<"u"?globalThis:n||self,r(n["check-update"]={}))})(this,function(n){"use strict";const y=new RegExp(/<script(?:\s+[^>]*)?>(.*?)<\/script\s*>|<link(?:\s+[^>]*)?>(.*?)/gi);let o="last_signature";const d=localStorage.getItem(o);let i=d?JSON.parse(d):[];const h=`${location.origin}/index.html`;let l="",u=null,s=!1;const m=async()=>{try{if(!l)return s=!0,"";const e=await fetch(`${l}?t=${Date.now()}`);if(e.status===200){const t=await e.text();return s=!1,t}else return s=!0,""}catch{return s=!0,""}},T=e=>(e==null?void 0:e.match(y))||[],w=async(e,t,a)=>{if(!window.navigator.onLine||s)return!1;const c=e.length,f=Array.from(new Set(e.concat(t)));if(c!==f.length){if(i=t,localStorage.setItem(o,JSON.stringify(i)),!c)return!1;a()}},I=()=>{console.log("The system version has been updatedï¼")},g=async e=>{const t=await m(),a=T(t);await w(i,a,e)},p=()=>{u&&clearInterval(u)},L=({init:e=1e4,loop:t=6e4,cb:a=I,url:c=h,cacheKey:f=o})=>{l=c,o=f,setTimeout(async()=>{await g(a),p(),u=setInterval(async()=>{await g(a)},t)},e)};n.checkUpdate=L,n.clearTimer=p,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
